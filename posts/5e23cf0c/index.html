<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Linux sed命令的使用 | violet7pan Blog</title><meta name="keywords" content="Linux"><meta name="author" content="violet7pan"><meta name="copyright" content="violet7pan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Linux sed命令的使用 PART1 Linux sed命令的基础 初识sed Reference: Sed Tutorial - Tutorialspoint. 字符流编辑工具(行编辑工具)，可以每行字符进行处理 优势：擅长对行进行处理；擅长对文件内容进行修改&#x2F;删除。  SED can be used in many different ways, such as:  Text substi">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux sed命令的使用">
<meta property="og:url" content="https://violet7pan.gitee.io/posts/5e23cf0c/index.html">
<meta property="og:site_name" content="violet7pan Blog">
<meta property="og:description" content="Linux sed命令的使用 PART1 Linux sed命令的基础 初识sed Reference: Sed Tutorial - Tutorialspoint. 字符流编辑工具(行编辑工具)，可以每行字符进行处理 优势：擅长对行进行处理；擅长对文件内容进行修改&#x2F;删除。  SED can be used in many different ways, such as:  Text substi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-19.webp">
<meta property="article:published_time" content="2021-02-20T15:26:32.000Z">
<meta property="article:modified_time" content="2021-06-14T03:47:35.631Z">
<meta property="article:author" content="violet7pan">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-19.webp"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://violet7pan.gitee.io/posts/5e23cf0c/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"PKY3F5HAHD","apiKey":"5e175a241d1eb8b01147dbb78d77842d","indexName":"prod_blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux sed命令的使用',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-06-14 11:47:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/MMengyiyu/HexoStaticFile@latest/css/custom.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/MMengyiyu/HexoStaticFile@latest/css/index.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="//at.alicdn.com/t/font_2405210_6tovfl8ipqu.css"><meta name="generator" content="Hexo 5.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">59</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-1mulu"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/OnePlus"><i class="fa-fw fas fa-mobile-alt"></i><span> OnePlus</span></a></li><li><a class="site-page child" href="/categories/Linux"><i class="fa-fw fab fa-linux"></i><span> Linux</span></a></li><li><a class="site-page child" href="/categories/Hexo"><i class="fa-fw fas fa-blog"></i><span> Hexo</span></a></li><li><a class="site-page child" href="/categories/XYplorer"><i class="fa-fw fas fa-folder-open"></i><span> XYplorer</span></a></li><li><a class="site-page child" href="/categories/Building"><i class="fa-fw fas fa-archway"></i><span> Building</span></a></li><li><a class="site-page child" href="/categories/AutoCAD"><i class="fa-fw fas fa-draw-polygon"></i><span> AutoCAD</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-19.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">violet7pan Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-1mulu"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/OnePlus"><i class="fa-fw fas fa-mobile-alt"></i><span> OnePlus</span></a></li><li><a class="site-page child" href="/categories/Linux"><i class="fa-fw fab fa-linux"></i><span> Linux</span></a></li><li><a class="site-page child" href="/categories/Hexo"><i class="fa-fw fas fa-blog"></i><span> Hexo</span></a></li><li><a class="site-page child" href="/categories/XYplorer"><i class="fa-fw fas fa-folder-open"></i><span> XYplorer</span></a></li><li><a class="site-page child" href="/categories/Building"><i class="fa-fw fas fa-archway"></i><span> Building</span></a></li><li><a class="site-page child" href="/categories/AutoCAD"><i class="fa-fw fas fa-draw-polygon"></i><span> AutoCAD</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux sed命令的使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-02-20T15:26:32.000Z" title="发表于 2021-02-20 23:26:32">2021-02-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-14T03:47:35.631Z" title="更新于 2021-06-14 11:47:35">2021-06-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/Command/">Command</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux sed命令的使用"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Linux-sed命令的使用">Linux sed命令的使用</h1>
<h1 id="PART1-Linux-sed命令的基础">PART1 Linux sed命令的基础</h1>
<h2 id="初识sed">初识sed</h2>
<p>Reference: <a target="_blank" rel="noopener" href="https://www.tutorialspoint.com/sed/index.htm">Sed Tutorial - Tutorialspoint</a>.</p>
<p>字符流编辑工具(行编辑工具)，可以每行字符进行处理</p>
<p>优势：擅长对行进行处理；擅长对文件内容进行修改/删除。</p>
<blockquote>
<p>SED can be used in many different ways, such as:</p>
<ul>
<li>Text substitution,</li>
<li>Selective printing of text files,</li>
<li>In-a-place editing of text files,</li>
<li>Non-interactive editing of text files, and many more</li>
</ul>
</blockquote>
<h2 id="sed工作流程">sed工作流程</h2>
<p>sed的工作流程图如下(本图源于<a target="_blank" rel="noopener" href="https://www.tutorialspoint.com/sed/index.htm">Sed Tutorial - Tutorialspoint</a>)</p>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/posts/5e23cf0c/sed_workflow.jpg" class="" title="sed_workflow">
<blockquote>
<ul>
<li><strong>Read</strong>: SED reads a line from the input stream (file, pipe, or stdin) and stores it in its internal buffer called <strong>pattern buffer</strong>.</li>
<li><strong>Execute</strong>: All SED commands are applied sequentially on the  pattern buffer. By default, SED commands are applied on all lines  (globally) unless line addressing is specified.</li>
<li><strong>Display</strong>: Send the (modified) contents to the output stream. After sending the data, the pattern buffer will be empty.</li>
<li>The above process repeats until the file is exhausted.</li>
</ul>
</blockquote>
<p>Point to Note:</p>
<blockquote>
<ul>
<li>Pattern buffer is a private, in-memory, volatile storage area used by the SED.</li>
<li>By default, all SED commands are applied on the pattern buffer,  hence the input file remains unchanged. GNU SED provides a way to modify the input file in-a-place. We will explore about it in later sections.</li>
<li>There is another memory area called <strong>hold buffer</strong> which is also private, in- memory, volatile storage area. Data can be stored in a hold buffer for later retrieval. At the end of each cycle, SED removes  the contents of the pattern buffer but the contents of the hold buffer  remains persistent between SED cycles. However SED commands cannot be directly executed on hold buffer, hence SED allows data movement between the hold buffer and the pattern buffer.</li>
<li>Initially both pattern and hold buffers are empty.</li>
<li>If no input files are provided, then SED accepts input from the standard input stream (stdin).</li>
<li>If address range is not provided by default, then SED operates on each line.</li>
</ul>
</blockquote>
<h2 id="sed的通用语法格式">sed的通用语法格式</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [OPTION]... [SCRIPT] [input-file]...</span><br></pre></td></tr></table></figure>
<p>[SCRIPT]: 可以用分号(;)分隔每一条表达式，每一条表达式应该是条件+命令组成的。比如&quot;1d&quot;(删除第一行), “1d;3d”(删除第1和3行), &quot;1d&quot;中’1’是条件范围，'d’是命令，表删除操作。</p>
<p>整个SCRIPT的所有表达式作为一个整体括起来时，最好使用单引号(')括起来，有些命令在双引号(&quot;)中无法正常使用，比如sed -n &quot;/^/!p"中无法识别'!'号，而使用sed -n '/^/!p’就可以正常使用。因此推荐单引号括[SCRIPT]，即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [OPTION]... &#39;[SCRIPT]&#39; [input-file]...</span><br></pre></td></tr></table></figure>
<h2 id="什么是pattern-space-模式空间">什么是pattern space(模式空间)?</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12833714/the-concept-of-hold-space-and-pattern-space-in-sed">linux - The Concept of ‘Hold space’ and ‘Pattern space’ in sed - Stack Overflow</a>:<br>
When sed reads a file line by line, the line that has been currently read is inserted into the <em>pattern</em> buffer (pattern space). Pattern buffer is like the temporary buffer, the scratchpad where the current information is stored. When you tell  sed to print, it prints the pattern buffer.</p>
</blockquote>
<p>pattern spaces又叫做pattern buffer(模式缓冲区)。</p>
<p>sed的工作流程可知，sed每读入输入文件流的一行内容，这一行内容就会插入模式缓冲区，也就是模式空间中，当所有行内容都读入后，文件内容全部都插入到模式空间了。</p>
<h2 id="什么是hold-space-保留空间">什么是hold space(保留空间)?</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12833714/the-concept-of-hold-space-and-pattern-space-in-sed">linux - The Concept of ‘Hold space’ and ‘Pattern space’ in sed - Stack Overflow</a>:</p>
<p>Hold buffer / hold space is like a long-term storage, such that you can catch something, store it and reuse it later when sed is processing  another line. You do not directly process the hold space, instead, you  need to copy it or append to the pattern space if you want to do  something with it. For example, the print command <code>p</code> prints the pattern space only. Likewise, <code>s</code> operates on the pattern space.</p>
</blockquote>
<p>hold space又叫做hold buffer(保留缓冲区)。只需知道保留缓冲区可以存储输入文件内容的数据，在sed处理其他一行信息时，会用到这个缓冲区的内容，并且你无法直接操作此区域。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.thegeekstuff.com/2009/12/unix-sed-tutorial-7-examples-for-sed-hold-and-pattern-buffer-operations/">Unix Sed Tutorial : 7 Examples for Sed Hold and Pattern Buffer Operations</a>:</p>
<p>As its name implies, <strong>sed hold buffer</strong> is used to save all or part of the <strong>sed pattern space</strong> for subsequent retrieval. The contents of the pattern space can be copied to the hold space, then back again. No operations are performed  directly on the hold space. sed provides a set of hold and get functions to handle these movements.</p>
<p>…</p>
</blockquote>
<h1 id="PART2-使用sed命令">PART2 使用sed命令</h1>
<p>Reference: <a target="_blank" rel="noopener" href="http://c.biancheng.net/view/4028.html">Linux sed命令完全攻略（超级详细）</a>.</p>
<h2 id="使用sed打印模式空间内容">使用sed打印模式空间内容</h2>
<h3 id="抑制-自动打印模式空间内容到终端-的特性-‘-n’">抑制&quot;自动打印模式空间内容到终端&quot;的特性(‘-n’)</h3>
<blockquote>
<p>Option ‘-n’</p>
<p><code>-n</code> (–quiet, --silent) - suppress automatic printing of pattern space</p>
<p>'p’用于表达式{script-only-if-no-other-script}中</p>
<p><code>p</code> - Print the current pattern space.</p>
</blockquote>
<p>从&quot;什么是pattern space(模式空间)?&quot;我们可以知道所有行内容都存在了模式空间，因此如果不指定<code>-n</code>选项，所有行内容会打印到终端上：</p>
<p>test.txt内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<p>'1p’表示打印输入文件的第一行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<p>可以发现虽然第一行打印了，但是整个文件内容也一并打印了。我们看看加上’-n’选项后会怎么样：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;1p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br></pre></td></tr></table></figure>
<p>由此可以知道sed命令处理完成之后，总是会把文件内容打印到终端，为了只获得相关内容，我们使用’-n’为了抑制这一特性。p命令总是配合’-n’一起使用。</p>
<h3 id="单行和多行捕获">单行和多行捕获</h3>
<p>sed p一般语法格式如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed [OPTIONS...] &#39;[ADDRESS]p&#39; INPUT_FILE</span><br><span class="line">sed [OPTIONS...] &#39;[ADDRESS]p;[ADDRESS]p;...&#39; INPUT_FILE</span><br></pre></td></tr></table></figure>
<ul>
<li>‘&lt;n&gt;p’ - 捕获输入文件内容的第n行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;1p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br></pre></td></tr></table></figure>
<ul>
<li>‘&lt;n&gt;,&lt;m&gt;p’ - 捕获输入文件内容的第n到m行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;1,3p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br></pre></td></tr></table></figure>
<ul>
<li>‘&lt;n1&gt;p;&lt;n2&gt;p;…;&lt;ni&gt;p’ - 捕获输入文件内容的多行，行号自定义</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;1p;3p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">103:PHP,GHI</span><br><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;1p;3p;4p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br></pre></td></tr></table></figure>
<h3 id="捕获匹配指定文本的行">捕获匹配指定文本的行</h3>
<ul>
<li>‘/[match_text…]/p’ - 捕获匹配指定文本([match_text…])的行.</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 找到包含<span class="string">&quot;Java&quot;</span>信息的行</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;/Java/p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br></pre></td></tr></table></figure>
<ul>
<li>‘/[match_text_1…]/p;/[match_text_2…]/p;…;/[match_text_i…]/p’ - 捕获匹配指定文本的多行.</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 找到包含<span class="string">&quot;Java&quot;</span>和<span class="string">&quot;PHP&quot;</span>的行</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;/Java/p;/PHP/p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">103:PHP,GHI</span><br></pre></td></tr></table></figure>
<h2 id="使用sed添加内容">使用sed添加内容</h2>
<blockquote>
<p>i \</p>
<p><u>test</u> - Insert text, which has each embedded newline preceded by a backslash.</p>
<p>a \</p>
<p><u>text</u> - Append text, which has each embedded newline preceded by a backslash.</p>
</blockquote>
<h3 id="每行前或后添加内容">每行前或后添加内容</h3>
<ul>
<li>‘i\[text]’ - 每一行之前都添加内容([text])</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;i\100:C++,QQQ&#x27;</span> test.txt</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者是:(可读性不好)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;i100:C++,QQQ&#x27;</span> test.txt</span></span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">100:C++,QQQ</span><br><span class="line">101:Java,ABC</span><br><span class="line">100:C++,QQQ</span><br><span class="line">102:Python,DEF</span><br><span class="line">100:C++,QQQ</span><br><span class="line">103:PHP,GHI</span><br><span class="line">100:C++,QQQ</span><br><span class="line">104:C,JKL</span><br><span class="line">100:C++,QQQ</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<p>同样地，也可以在每一行后面添加内容</p>
<ul>
<li>‘a\[text]’ - 每一行之后都添加内容([text])</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;a\100:C++,QQQ&#x27;</span> test.txt</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者是:(可读性不好)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;a100:C++,QQQ&#x27;</span> test.txt</span></span><br></pre></td></tr></table></figure>
<h3 id="指定行前或后添加内容">指定行前或后添加内容</h3>
<p>在指定的行之前插入内容</p>
<ul>
<li>‘&lt;n&gt;i\[text]’ - 在第n行之前插入内容([text])</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1i\100:C++,QQQ&#x27;</span> test.txt</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者是:(可读性不好)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1i100:C++,QQQ&#x27;</span> test.txt</span></span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">100:C++,QQQ</span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<p>同样地，也可以在指定的行之后插入内容</p>
<ul>
<li>‘&lt;n&gt;a\[text]’ - 在第n行之后插入内容([text])</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1a\100:C++,QQQ&#x27;</span> test.txt</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者是:(可读性不好)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1a100:C++,QQQ&#x27;</span> test.txt</span></span><br></pre></td></tr></table></figure>
<p>注意，由于你的操作都是在缓冲区完成的，并且缓冲区的内容没有写入到原文件，因此这些上述sed命令并不会修改原文件。</p>
<h3 id="匹配指定文本的行前或后添加内容">匹配指定文本的行前或后添加内容</h3>
<ul>
<li>
<p>‘/[match_text…]/i\[text]’ - 在匹配了指定文本([match_text…])的行之前添加内容([text])</p>
</li>
<li>
<p>‘/[match_text…]/a\[text]’ - 在匹配了指定文本([match_text…])的行之后添加内容([text])</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;/Java/i\222:C#,GGG&#x27;</span> test.txt</span></span><br><span class="line">222:C#,GGG</span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;/Java/a\222:C#,GGG&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">222:C#,GGG</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<h3 id="交互式添加内容">交互式添加内容</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 输入sed <span class="string">&#x27;li\然后回车就可以添加内容了</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1i\</span></span></span><br><span class="line"><span class="bash">&gt; Hello world!<span class="string">&#x27; test.txt</span></span></span><br><span class="line">Hello world!</span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<h2 id="使用sed删除内容">使用sed删除内容</h2>
<h3 id="删除单行">删除单行</h3>
<ul>
<li>‘&lt;n&gt;d’ - 删除第n行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1d&#x27;</span> test.txt</span> </span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<h3 id="删除多行">删除多行</h3>
<ul>
<li>‘&lt;n,m&gt;d’ - 删除第n~m行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1,3d&#x27;</span> test.txt</span> </span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<ul>
<li>‘&lt;n1&gt;d;&lt;n2&gt;d;…;&lt;ni&gt;d’ - 删除输入文件内容的多行，行号自定义</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1d;3d;5d&#x27;</span> test.txt</span> </span><br><span class="line">102:Python,DEF</span><br><span class="line">104:C,JKL</span><br></pre></td></tr></table></figure>
<h3 id="删除匹配指定文本的行">删除匹配指定文本的行</h3>
<ul>
<li>‘/[match_text…]/d’ - 删除匹配文本的行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 删除包含<span class="string">&quot;Java&quot;</span>的行</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;/Java/d&#x27;</span> test.txt</span></span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<ul>
<li>‘/[match_text_1…]/,/[match_text_2…]d’ - 删除匹配文本1和文本2之间的所有行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 删除包含<span class="string">&quot;Java&quot;</span>和<span class="string">&quot;PHP&quot;</span>之间的行</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;/Java/,/PHP/d&#x27;</span> test.txt</span></span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<ul>
<li>‘/[match_text_1…]/d;/[match_text_2…]/d;…;/[match_text_i…]/d’ - 删除匹配指定文本的多行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 删除包含<span class="string">&quot;Java&quot;</span>和<span class="string">&quot;PHP&quot;</span>的行</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;/Java/d;/PHP/d&#x27;</span> test.txt</span></span><br><span class="line">102:Python,DEF</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<p>一个重要应用实例：(删除空行内容,See also: <a target="_blank" rel="noopener" href="https://www.cyberciti.biz/faq/using-sed-to-delete-empty-lines/">How to delete empty lines using sed command under Linux / UNIX - nixCraft</a>)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line"></span><br><span class="line">105:Linux,MNO</span><br><span class="line"><span class="meta">$</span><span class="bash"> sed -n <span class="string">&#x27;/^$/!p&#x27;</span> test.txt</span></span><br><span class="line">101:Java,ABC</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<h2 id="使用sed查找并替换-处理结果不写入原文件">使用sed查找并替换(处理结果不写入原文件)</h2>
<h3 id="查找并替换">查找并替换</h3>
<p>一般语法格式如下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [不包括(&#x27;-i&#x27;)的OPTIONS...] &#x27;s/SEARCH_REGEX/REPLACEMENT/g&#x27; INPUTFILE</span><br></pre></td></tr></table></figure>
<p>'g’为全局替换标志，如果不添加这个标志，只替换每行匹配的第一个信息</p>
<h3 id="替换所有行">替换所有行</h3>
<p>一般语法格式如下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [不包括(&#x27;-i&#x27;)的OPTIONS...] &#x27;c\REPLACEMENT&#x27; INPUTFILE</span><br></pre></td></tr></table></figure>
<p>举例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;c\Hello world!&#x27;</span> test.txt</span></span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者是:(可读性不好)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;cHello world!&#x27;</span> test.txt</span></span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>
<h3 id="替换指定行">替换指定行</h3>
<ul>
<li>‘&lt;n&gt;c\[REPLACEMENT]’ - 第n行的内容替换为REPLACEMENT</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1c\Hello world!&#x27;</span> test.txt</span></span><br><span class="line">Hello world!</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者是:(可读性不好)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1cHello world!&#x27;</span> test.txt</span></span><br><span class="line">Hello world!</span><br><span class="line">102:Python,DEF</span><br><span class="line">103:PHP,GHI</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<ul>
<li>‘&lt;n&gt;,&lt;\m&gt;c\[REPLACEMENT]’ - 第n~m行的内容替换为REPLACEMENT(注意：替换后多行内容变成一行内容)</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sed <span class="string">&#x27;1,3c\Hello world!&#x27;</span> test.txt</span></span><br><span class="line">Hello world!</span><br><span class="line">104:C,JKL</span><br><span class="line">105:Linux,MNO</span><br></pre></td></tr></table></figure>
<h2 id="使用sed查找并替换字符串">使用sed查找并替换字符串</h2>
<p>Reference: <a target="_blank" rel="noopener" href="https://linuxize.com/post/how-to-use-sed-to-find-and-replace-string-in-files/">How to Use sed to Find and Replace String in Files | Linuxize</a></p>
<h3 id="替换用法的语法格式">替换用法的语法格式</h3>
<blockquote>
<p>The general form of searching and replacing text using <code>sed</code> takes the following form:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/SEARCH_REGEX/REPLACEMENT/g&#x27;</span> INPUTFILE</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-i</code> - By default, <code>sed</code> writes its output to the standard output. This option tells <code>sed</code> to edit files in place. If an extension is supplied (ex -i.bak), a backup of the original file is created.</li>
<li><code>s</code> - The substitute command, probably the most used command in sed.</li>
<li><code>/ / /</code> - Delimiter character. It can be any character but usually the slash (<code>/</code>) character is used.</li>
<li><code>SEARCH_REGEX</code> - Normal string or a regular expression to search for.</li>
<li><code>REPLACEMENT</code> - The replacement string.</li>
<li><code>g</code> - Global replacement flag. By default, <code>sed</code> reads the file line by line and changes only the first occurrence of the <code>SEARCH_REGEX</code> on a line. When the replacement flag is provided, all occurrences are replaced.</li>
<li><code>INPUTFILE</code> - The name of the file on which you want to run the command.</li>
</ul>
<p>It is a good practice to put quotes around the argument so the shell meta-characters won’t expand.</p>
</blockquote>
<p>假定存在这样的一个文件内容:</p>
<p>file.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123 foo foo </span><br><span class="line">foo &#x2F;bin&#x2F;bash Ubuntu foobar 456</span><br></pre></td></tr></table></figure>
<h3 id="指定是否全局匹配">指定是否全局匹配</h3>
<p><code>g</code>标志没有加上，则只有每行第一个匹配的字符串被替换</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/foo/linux/&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>file.txt输出内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123 Foo linux foo </span><br><span class="line">linux &#x2F;bin&#x2F;bash Ubuntu foobar 456</span><br></pre></td></tr></table></figure>
<h3 id="替换时是否创建备份">替换时是否创建备份</h3>
<p>如果在<code>-i</code>后面加上后缀(比如.bak)，则替换时会创建一个备份</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i.bak &#x27;s/foo/linux/&#x27; file.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ls -l file*</span><br><span class="line">-rw-r--r-- 1 root root 49 Jan  7 14:16 file.txt</span><br><span class="line">-rw-r--r-- 1 root root 49 Jan  7 14:14 file.txt.bak</span><br><span class="line">[root@localhost ~]# cat file.txt</span><br><span class="line">123 Foo linux foo </span><br><span class="line">linux &#x2F;bin&#x2F;bash Ubuntu foobar 456</span><br><span class="line">[root@localhost ~]# cat file.txt.bak </span><br><span class="line">123 Foo foo foo </span><br><span class="line">foo &#x2F;bin&#x2F;bash Ubuntu foobar 456</span><br></pre></td></tr></table></figure>
<p><code>g</code>标志加上，则每行所有匹配上的字符串都会被替换</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/foo/linux/g&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123 Foo linux linux</span><br><span class="line">linux &#x2F;bin&#x2F;bash Ubuntu linuxbar 456</span><br></pre></td></tr></table></figure>
<p>可以看到&quot;foobar&quot;被替换为&quot;linuxbar&quot;，如果不想要这些情况发生，需要在<code>SEARCH_REGEX</code>两边加上单词边界表达式(<code>\b</code>)，这样匹配字符串时会检查字符串是不是完整的一个单词</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/\bfoo\b/linux/g&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123 Foo linux linux</span><br><span class="line">linux &#x2F;bin&#x2F;bash Ubuntu foobar 456</span><br></pre></td></tr></table></figure>
<p>如果想要匹配规则对大小写不区分，可以加上<code>I</code>标志，以下例子加上了<code>g</code>和<code>I</code>标志</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/foo/linux/gI&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123 linux linux linux </span><br><span class="line">linux &#x2F;bin&#x2F;bash Ubuntu linuxbar 456</span><br></pre></td></tr></table></figure>
<h3 id="匹配转义字符">匹配转义字符</h3>
<p>如果涉及匹配转义字符(比如分界符<code>/</code>)，那么你需要在转义字符之前加上反斜线(<code>\</code>)进行转义。以下例子会把&quot;/bin/bash&quot;匹配为&quot;/usr/bin/zsh&quot;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/\/bin\/bash/\/usr\/bin\/zsh/g&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>Delimiter character不仅可以使用’/‘,你可以使用其他分界符让匹配字符串和替换字符串可读性更强，比如’#‘,’|’</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;s|\&#x2F;bin\&#x2F;bash|\&#x2F;usr\&#x2F;bin\&#x2F;zsh|g&#39; file.txt</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123 Foo linux foo </span><br><span class="line">linux &#x2F;usr&#x2F;bin&#x2F;zsh Ubuntu foobar 456</span><br></pre></td></tr></table></figure>
<h3 id="使用正则表达式">使用正则表达式</h3>
<p><code>SEARCH_REGEX</code>中可以使用正则表达式，比如将&quot;456&quot;和&quot;123&quot;这样的三位数字替换为&quot;number&quot;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/\b[0-9]\&#123;3\&#125;\b/number/g&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">number Foo foo foo </span><br><span class="line">foo &#x2F;bin&#x2F;bash Ubuntu foobar number</span><br></pre></td></tr></table></figure>
<p>可以使用<code>$</code>代表<code>SEARCH_REGEX</code>(匹配字符串)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/\b[0-9]\&#123;3\&#125;\b/&#123;&amp;&#125;/g&#x27; file.txt</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;123&#125; Foo foo foo </span><br><span class="line">foo &#x2F;bin&#x2F;bash demo foobar &#123;456&#125;</span><br></pre></td></tr></table></figure>
<p>该在该例中’$'代表了三位数字(其正则表达式&quot;\b[0-9]{3}\b&quot;)</p>
<p>指定’-r’选项后sed命令支持处理扩展正则表达式(ERE):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -r [OTHER_OPTIONS...] &#39;[SCRIPT...]&#39; [INPUT_FILE]</span><br></pre></td></tr></table></figure>
<h2 id="案例">案例</h2>
<h3 id="取出主机ip地址的实例">取出主机ip地址的实例</h3>
<p>取出32位IP地址</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ip a s ens33</span></span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:26:0a:2d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.10.4/24 brd 192.168.10.255 scope global noprefixroute ens33</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::49f:e3c8:3439:abf6/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta">$</span><span class="bash"> ip a s ens33 | sed -n <span class="string">&#x27;3p&#x27;</span></span></span><br><span class="line">    inet 192.168.10.4/24 brd 192.168.10.255 scope global noprefixroute ens33</span><br><span class="line"><span class="meta">$</span><span class="bash"> ip a s ens33 | sed -n <span class="string">&#x27;3p&#x27;</span> | sed -rn <span class="string">&#x27;s/^.*inet (.*)/\1/gp&#x27;</span></span></span><br><span class="line">192.168.10.4/24 brd 192.168.10.255 scope global noprefixroute ens33</span><br><span class="line"><span class="meta">$</span><span class="bash"> ip a s ens33 | sed -n <span class="string">&#x27;3p&#x27;</span> | sed -rn <span class="string">&#x27;s/^.*inet (.*)/\1/gp&#x27;</span> | sed -rn <span class="string">&#x27;s/(.*)\/.*/\1/gp&#x27;</span></span></span><br><span class="line">192.168.10.4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 对于sed命令进行整合优化:</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ip a s ens33 | sed -rn <span class="string">&#x27;3s/^.*inet (.*)\/.*/\1/gp&#x27;</span></span></span><br><span class="line">192.168.10.4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 形如<span class="string">&#x27;s/SEARCH_REGEX/REPLACEMENT/g&#x27;</span>中<span class="string">&#x27;/&#x27;</span>只是作为分隔符，如果可读性差可以换成其他分隔符，比如<span class="string">&#x27;|&#x27;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 后项引用前项:<span class="string">&#x27;\1&#x27;</span>的内容引用了前面(.*)小括号之间的内容</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ip a s ens33 | sed -rn <span class="string">&#x27;3s|^.*inet (.*)\/.*|\1|gp&#x27;</span></span></span><br><span class="line">192.168.10.4</span><br></pre></td></tr></table></figure>
<h3 id="批量修改文件扩展名的实例">批量修改文件扩展名的实例</h3>
<p>将&quot;violet01.txt&quot;~“violet10.txt&quot;修改为&quot;violet01.jpg”~“violet10.jpg”</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> touch violet&#123;01..10&#125;.txt</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls violet??.txt</span></span><br><span class="line">violet01.txt  violet03.txt  violet05.txt  violet07.txt  violet09.txt</span><br><span class="line">violet02.txt  violet04.txt  violet06.txt  violet08.txt  violet10.txt</span><br><span class="line"><span class="meta">$</span><span class="bash"> ls violet??.txt | sed -nr <span class="string">&#x27;s|(.*).txt|\1.txt \1.jpg|gp&#x27;</span></span></span><br><span class="line">violet01.txt violet01.jpg</span><br><span class="line">violet02.txt violet02.jpg</span><br><span class="line">violet03.txt violet03.jpg</span><br><span class="line">violet04.txt violet04.jpg</span><br><span class="line">violet05.txt violet05.jpg</span><br><span class="line">violet06.txt violet06.jpg</span><br><span class="line">violet07.txt violet07.jpg</span><br><span class="line">violet08.txt violet08.jpg</span><br><span class="line">violet09.txt violet09.jpg</span><br><span class="line">violet10.txt violet10.jpg</span><br><span class="line"><span class="meta">$</span><span class="bash"> ls violet??.txt | sed -nr <span class="string">&#x27;s|(.*).txt|\1.txt \1.jpg|gp&#x27;</span> | xargs -n2 mv</span></span><br><span class="line">[root@localhost ~]# ll</span><br><span class="line">total 32</span><br><span class="line">...</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet01.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet02.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet03.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet04.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet05.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet06.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet07.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet08.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet09.jpg</span><br><span class="line">-rw-r--r--  1 root root    0 Jan 17 15:10 violet10.jpg</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>其他方法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">&#x27;&amp;&#x27;</span>代表替换前的内容,该用法有些像xargs -i cp &#123;&#125; ~\中的<span class="string">&#x27;&#123;&#125;&#x27;</span>，有点类似后项引用前项的感觉。</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls violet*.txt | sed -r <span class="string">&#x27;s|(.*)txt|mv &amp; \1jpg|g&#x27;</span> | bash</span></span><br></pre></td></tr></table></figure>
<p>对于重命名，可以使用rename命令</p>
<p>重命名语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename [options] expression replacement file...</span><br></pre></td></tr></table></figure>
<blockquote>
<p>expression - 原文件需要修改的部分</p>
<p>replacement - 修改的内容</p>
<p>file… - 输入的原文件</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rename .txt .jpg violet*.txt</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ll violet*.jpg</span></span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet01.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet02.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet03.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet04.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet05.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet06.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet07.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet08.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet09.jpg</span><br><span class="line">-rw-r--r-- 1 root root 0 Jan 17 15:10 violet10.jpg</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Linux sed命令的使用</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://violet7pan.gitee.io/posts/5e23cf0c/">https://violet7pan.gitee.io/posts/5e23cf0c/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>violet7pan</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2021-02-20</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2021-06-14</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/60bc5e22/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-16.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux awk命令</div></div></a></div><div class="next-post pull-right"><a href="/posts/9bbe274e/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-16.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux如何配置网络</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/c2e31e6/" title="CentOS7系统优化脚本"><img class="cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-2.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-20</div><div class="title">CentOS7系统优化脚本</div></div></a></div><div><a href="/posts/9bbe274e/" title="Linux如何配置网络"><img class="cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-16.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-20</div><div class="title">Linux如何配置网络</div></div></a></div><div><a href="/posts/7821e3ee/" title="CentOS6,7/Ubuntu镜像下载与安装至VM虚拟机"><img class="cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-5.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-20</div><div class="title">CentOS6,7/Ubuntu镜像下载与安装至VM虚拟机</div></div></a></div><div><a href="/posts/887a2cdf/" title="Linux find命令的使用"><img class="cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-21.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-20</div><div class="title">Linux find命令的使用</div></div></a></div><div><a href="/posts/7b277ce5/" title="Linux-Command-tar"><img class="cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-9.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">Linux-Command-tar</div></div></a></div><div><a href="/posts/ff26220a/" title="Linux-UserManagement"><img class="cover" src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-18</div><div class="title">Linux-UserManagement</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">violet7pan</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">59</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/violet7pan"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux-sed%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">Linux sed命令的使用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PART1-Linux-sed%E5%91%BD%E4%BB%A4%E7%9A%84%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">PART1 Linux sed命令的基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86sed"><span class="toc-number">2.1.</span> <span class="toc-text">初识sed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sed%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">2.2.</span> <span class="toc-text">sed工作流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sed%E7%9A%84%E9%80%9A%E7%94%A8%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.3.</span> <span class="toc-text">sed的通用语法格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFpattern-space-%E6%A8%A1%E5%BC%8F%E7%A9%BA%E9%97%B4"><span class="toc-number">2.4.</span> <span class="toc-text">什么是pattern space(模式空间)?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFhold-space-%E4%BF%9D%E7%95%99%E7%A9%BA%E9%97%B4"><span class="toc-number">2.5.</span> <span class="toc-text">什么是hold space(保留空间)?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PART2-%E4%BD%BF%E7%94%A8sed%E5%91%BD%E4%BB%A4"><span class="toc-number">3.</span> <span class="toc-text">PART2 使用sed命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sed%E6%89%93%E5%8D%B0%E6%A8%A1%E5%BC%8F%E7%A9%BA%E9%97%B4%E5%86%85%E5%AE%B9"><span class="toc-number">3.1.</span> <span class="toc-text">使用sed打印模式空间内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%91%E5%88%B6-%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%B0%E6%A8%A1%E5%BC%8F%E7%A9%BA%E9%97%B4%E5%86%85%E5%AE%B9%E5%88%B0%E7%BB%88%E7%AB%AF-%E7%9A%84%E7%89%B9%E6%80%A7-%E2%80%98-n%E2%80%99"><span class="toc-number">3.1.1.</span> <span class="toc-text">抑制&quot;自动打印模式空间内容到终端&quot;的特性(‘-n’)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%92%8C%E5%A4%9A%E8%A1%8C%E6%8D%95%E8%8E%B7"><span class="toc-number">3.1.2.</span> <span class="toc-text">单行和多行捕获</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%95%E8%8E%B7%E5%8C%B9%E9%85%8D%E6%8C%87%E5%AE%9A%E6%96%87%E6%9C%AC%E7%9A%84%E8%A1%8C"><span class="toc-number">3.1.3.</span> <span class="toc-text">捕获匹配指定文本的行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sed%E6%B7%BB%E5%8A%A0%E5%86%85%E5%AE%B9"><span class="toc-number">3.2.</span> <span class="toc-text">使用sed添加内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%8F%E8%A1%8C%E5%89%8D%E6%88%96%E5%90%8E%E6%B7%BB%E5%8A%A0%E5%86%85%E5%AE%B9"><span class="toc-number">3.2.1.</span> <span class="toc-text">每行前或后添加内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E8%A1%8C%E5%89%8D%E6%88%96%E5%90%8E%E6%B7%BB%E5%8A%A0%E5%86%85%E5%AE%B9"><span class="toc-number">3.2.2.</span> <span class="toc-text">指定行前或后添加内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E6%8C%87%E5%AE%9A%E6%96%87%E6%9C%AC%E7%9A%84%E8%A1%8C%E5%89%8D%E6%88%96%E5%90%8E%E6%B7%BB%E5%8A%A0%E5%86%85%E5%AE%B9"><span class="toc-number">3.2.3.</span> <span class="toc-text">匹配指定文本的行前或后添加内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E4%BA%92%E5%BC%8F%E6%B7%BB%E5%8A%A0%E5%86%85%E5%AE%B9"><span class="toc-number">3.2.4.</span> <span class="toc-text">交互式添加内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sed%E5%88%A0%E9%99%A4%E5%86%85%E5%AE%B9"><span class="toc-number">3.3.</span> <span class="toc-text">使用sed删除内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%8D%95%E8%A1%8C"><span class="toc-number">3.3.1.</span> <span class="toc-text">删除单行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%A4%9A%E8%A1%8C"><span class="toc-number">3.3.2.</span> <span class="toc-text">删除多行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%8C%B9%E9%85%8D%E6%8C%87%E5%AE%9A%E6%96%87%E6%9C%AC%E7%9A%84%E8%A1%8C"><span class="toc-number">3.3.3.</span> <span class="toc-text">删除匹配指定文本的行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sed%E6%9F%A5%E6%89%BE%E5%B9%B6%E6%9B%BF%E6%8D%A2-%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%9C%E4%B8%8D%E5%86%99%E5%85%A5%E5%8E%9F%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">使用sed查找并替换(处理结果不写入原文件)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%B9%B6%E6%9B%BF%E6%8D%A2"><span class="toc-number">3.4.1.</span> <span class="toc-text">查找并替换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E6%89%80%E6%9C%89%E8%A1%8C"><span class="toc-number">3.4.2.</span> <span class="toc-text">替换所有行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E6%8C%87%E5%AE%9A%E8%A1%8C"><span class="toc-number">3.4.3.</span> <span class="toc-text">替换指定行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sed%E6%9F%A5%E6%89%BE%E5%B9%B6%E6%9B%BF%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">3.5.</span> <span class="toc-text">使用sed查找并替换字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E7%94%A8%E6%B3%95%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.5.1.</span> <span class="toc-text">替换用法的语法格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%98%AF%E5%90%A6%E5%85%A8%E5%B1%80%E5%8C%B9%E9%85%8D"><span class="toc-number">3.5.2.</span> <span class="toc-text">指定是否全局匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E6%97%B6%E6%98%AF%E5%90%A6%E5%88%9B%E5%BB%BA%E5%A4%87%E4%BB%BD"><span class="toc-number">3.5.3.</span> <span class="toc-text">替换时是否创建备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="toc-number">3.5.4.</span> <span class="toc-text">匹配转义字符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.5.5.</span> <span class="toc-text">使用正则表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">3.6.</span> <span class="toc-text">案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E5%87%BA%E4%B8%BB%E6%9C%BAip%E5%9C%B0%E5%9D%80%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="toc-number">3.6.1.</span> <span class="toc-text">取出主机ip地址的实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="toc-number">3.6.2.</span> <span class="toc-text">批量修改文件扩展名的实例</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/3b4634fc/" title="Hexo使用"><img src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-20.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo使用"/></a><div class="content"><a class="title" href="/posts/3b4634fc/" title="Hexo使用">Hexo使用</a><time datetime="2021-06-07T12:08:35.000Z" title="发表于 2021-06-07 20:08:35">2021-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/24caea6b/" title="Hexo常用命令"><img src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-11.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo常用命令"/></a><div class="content"><a class="title" href="/posts/24caea6b/" title="Hexo常用命令">Hexo常用命令</a><time datetime="2021-06-07T06:10:13.000Z" title="发表于 2021-06-07 14:10:13">2021-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/82079eb1/" title="Hexo隐藏文章"><img src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo隐藏文章"/></a><div class="content"><a class="title" href="/posts/82079eb1/" title="Hexo隐藏文章">Hexo隐藏文章</a><time datetime="2021-06-04T11:00:41.000Z" title="发表于 2021-06-04 19:00:41">2021-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/82079eb1/" title="Hexo贴文Front-Matter用法"><img src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-12.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo贴文Front-Matter用法"/></a><div class="content"><a class="title" href="/posts/82079eb1/" title="Hexo贴文Front-Matter用法">Hexo贴文Front-Matter用法</a><time datetime="2021-06-01T11:37:37.000Z" title="发表于 2021-06-01 19:37:37">2021-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b757e37c/" title="我的Buttefly主题魔改历程"><img src="https://cdn.jsdelivr.net/gh/MMengyiyu/PicHosting/pic/post_cover-2.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="我的Buttefly主题魔改历程"/></a><div class="content"><a class="title" href="/posts/b757e37c/" title="我的Buttefly主题魔改历程">我的Buttefly主题魔改历程</a><time datetime="2021-06-01T08:52:32.000Z" title="发表于 2021-06-01 16:52:32">2021-06-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By violet7pan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/algolia.js"></script><div class="js-pjax"></div><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>